<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#0a0a0f">
    <title>Wordly</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #0a0a0f;
            --bg2: #12121a;
            --card: linear-gradient(145deg, #1a1a2e, #16162a);
            --gold: #d4a574;
            --purple: #7c6aef;
            --text: #f5f5f7;
            --muted: #606070;
            --green: #4ade80;
            --red: #f87171;
            --glass: rgba(255,255,255,0.03);
            --border: rgba(255,255,255,0.08);
        }
        * { margin:0; padding:0; box-sizing:border-box; -webkit-tap-highlight-color:transparent; }
        html,body { overscroll-behavior:none; }
        body {
            font-family: 'Manrope', -apple-system, sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100dvh;
        }
        .orb { position:fixed; border-radius:50%; filter:blur(80px); opacity:0.4; pointer-events:none; z-index:0; }
        .orb1 { width:300px; height:300px; background:var(--purple); top:-100px; right:-100px; }
        .orb2 { width:250px; height:250px; background:var(--gold); bottom:20%; left:-80px; }
        
        .app { position:relative; z-index:1; padding:16px; padding-top:calc(12px + env(safe-area-inset-top)); padding-bottom:70px; min-height:100dvh; }
        .header { display:flex; justify-content:space-between; align-items:center; margin-bottom:16px; }
        .page-title { font-size:24px; font-weight:800; }
        
        /* Card */
        .card-wrap { perspective:1000px; margin-bottom:20px; }
        .card { width:100%; height:320px; position:relative; transform-style:preserve-3d; transition:transform 0.6s; cursor:pointer; }
        .card.flipped { transform:rotateY(180deg); }
        .card-face { position:absolute; width:100%; height:100%; backface-visibility:hidden; border-radius:24px; display:flex; flex-direction:column; align-items:center; justify-content:center; padding:30px; text-align:center; }
        .card-front { background:var(--card); border:1px solid var(--border); }
        .card-back { background:linear-gradient(145deg, #1e1e3a, #1a1a30); border:1px solid var(--border); transform:rotateY(180deg); }
        .card-cat { font-size:12px; color:var(--gold); font-weight:600; text-transform:uppercase; letter-spacing:1px; margin-bottom:16px; }
        .card-word { font-size:32px; font-weight:800; margin-bottom:8px; }
        .card-phon { font-size:14px; color:var(--muted); margin-bottom:12px; }
        .card-trans { font-size:28px; font-weight:700; color:var(--gold); }
        .card-ex { font-size:14px; color:var(--muted); margin-top:16px; line-height:1.5; }
        .card-ex em { color:var(--green); font-style:normal; font-weight:600; }
        .tap-hint { font-size:12px; color:var(--muted); margin-top:auto; }
        
        .home-counter { text-align:center; font-size:13px; color:var(--muted); margin-bottom:12px; }
        .mode-switch { display:flex; gap:8px; margin-bottom:16px; }
        .mode-btn { flex:1; padding:10px; border:1px solid var(--border); background:var(--glass); border-radius:12px; color:var(--muted); font-size:13px; font-weight:600; cursor:pointer; transition:all 0.2s; }
        .mode-btn.on { background:var(--purple); color:#fff; border-color:var(--purple); }
        
        .btns { display:flex; justify-content:center; gap:16px; }
        .btn { width:64px; height:64px; border-radius:50%; border:none; font-size:24px; cursor:pointer; transition:all 0.2s; }
        .btn:active { transform:scale(0.9); }
        .btn-no { background:linear-gradient(135deg, #ff6b6b, #ee5a5a); }
        .btn-skip { background:var(--glass); border:1px solid var(--border); }
        .btn-yes { background:linear-gradient(135deg, #4ade80, #22c55e); }
        
        /* Views */
        .view { display:none; }
        .view.on { display:block; }
        
        /* Decks */
        .decks { display:grid; grid-template-columns:1fr 1fr; gap:12px; }
        .deck { background:var(--card); border:1px solid var(--border); border-radius:16px; padding:16px; cursor:pointer; transition:all 0.2s; }
        .deck:active { transform:scale(0.97); }
        .deck-icon { font-size:32px; margin-bottom:8px; }
        .deck-name { font-size:14px; font-weight:600; margin-bottom:4px; }
        .deck-cnt { font-size:12px; color:var(--muted); }
        .deck-add { border:2px dashed var(--border); background:transparent; display:flex; flex-direction:column; align-items:center; justify-content:center; color:var(--muted); }
        .deck-add:hover { border-color:var(--purple); color:var(--purple); }
        
        .detail-head { display:flex; align-items:center; gap:12px; margin-bottom:16px; }
        .back-btn { width:36px; height:36px; border-radius:50%; background:var(--glass); border:1px solid var(--border); color:var(--text); font-size:18px; cursor:pointer; }
        .detail-title { font-size:20px; font-weight:700; flex:1; }
        .detail-actions { display:flex; gap:8px; }
        .detail-btn { padding:8px 12px; border-radius:8px; border:none; font-size:12px; cursor:pointer; }
        .detail-btn.edit { background:var(--glass); border:1px solid var(--border); color:var(--text); }
        .detail-btn.delete { background:var(--red); color:#fff; }
        
        .words { display:flex; flex-direction:column; gap:8px; margin-bottom:16px; }
        .word-item { background:var(--glass); border:1px solid var(--border); border-radius:12px; padding:12px 16px; display:flex; justify-content:space-between; align-items:center; cursor:pointer; }
        .word-item:active { background:var(--border); }
        .word-w { font-weight:600; margin-bottom:2px; }
        .word-t { font-size:13px; color:var(--muted); }
        .word-status { width:8px; height:8px; border-radius:50%; background:var(--muted); }
        .word-status.learned { background:var(--green); }
        .word-status.learning { background:var(--gold); }
        
        .study-btn { width:100%; padding:14px; background:linear-gradient(135deg, var(--purple), #6366f1); border:none; border-radius:14px; color:#fff; font-size:15px; font-weight:700; cursor:pointer; }
        
        /* Progress */
        .streak-card { background:var(--card); border:1px solid var(--border); border-radius:20px; padding:20px; display:flex; align-items:center; gap:16px; margin-bottom:20px; }
        .streak-icon { font-size:40px; }
        .streak-info h3 { font-size:20px; font-weight:700; }
        .streak-info p { font-size:13px; color:var(--muted); }
        .stats-grid { display:grid; grid-template-columns:repeat(3,1fr); gap:10px; margin-bottom:20px; }
        .stat-card { background:var(--glass); border:1px solid var(--border); border-radius:14px; padding:14px; text-align:center; }
        .stat-val { font-size:24px; font-weight:800; }
        .stat-val.green { color:var(--green); }
        .stat-val.purple { color:var(--purple); }
        .stat-lbl { font-size:11px; color:var(--muted); margin-top:4px; }
        .section-title { font-size:14px; font-weight:600; color:var(--muted); margin-bottom:12px; }
        .week-chart { display:flex; gap:6px; align-items:flex-end; height:80px; }
        .week-bar { flex:1; background:var(--glass); border-radius:6px; min-height:8px; display:flex; flex-direction:column; justify-content:flex-end; align-items:center; padding-bottom:4px; }
        .week-bar-fill { width:100%; background:linear-gradient(to top, var(--purple), var(--gold)); border-radius:6px; }
        .week-bar span { font-size:9px; color:var(--muted); margin-top:4px; }
        
        /* Form */
        .form-group { margin-bottom:14px; }
        .form-lbl { display:block; font-size:12px; color:var(--muted); margin-bottom:6px; font-weight:500; }
        .form-input { width:100%; background:var(--glass); border:1px solid var(--border); border-radius:12px; padding:12px 14px; color:var(--text); font-size:14px; font-family:inherit; }
        .form-input:focus { outline:none; border-color:var(--purple); }
        .submit-btn { width:100%; padding:14px; background:linear-gradient(135deg, var(--gold), #c4956a); border:none; border-radius:14px; color:#000; font-size:15px; font-weight:700; cursor:pointer; margin-top:8px; }
        
        /* Settings */
        .section { background:var(--glass); border:1px solid var(--border); border-radius:16px; padding:16px; margin-bottom:12px; }
        .section-head { font-size:12px; color:var(--muted); font-weight:600; text-transform:uppercase; letter-spacing:0.5px; margin-bottom:12px; }
        .row { display:flex; justify-content:space-between; align-items:center; padding:10px 0; border-bottom:1px solid var(--border); }
        .row:last-child { border-bottom:none; }
        .row span { font-size:14px; }
        .toggle { width:44px; height:26px; background:var(--muted); border-radius:13px; position:relative; cursor:pointer; transition:background 0.2s; }
        .toggle.on { background:var(--green); }
        .toggle::after { content:''; position:absolute; width:22px; height:22px; background:#fff; border-radius:50%; top:2px; left:2px; transition:left 0.2s; }
        .toggle.on::after { left:20px; }
        .cnt-btn { padding:8px 14px; background:var(--glass); border:1px solid var(--border); border-radius:8px; color:var(--text); font-size:13px; cursor:pointer; }
        .cnt-btn.on { background:var(--purple); border-color:var(--purple); }
        .cnt-btn.danger { background:var(--red); border-color:var(--red); color:#fff; }
        .cnt-sel { display:flex; gap:6px; }
        
        /* Nav */
        .nav { position:fixed; bottom:0; left:0; right:0; background:rgba(10,10,15,0.95); backdrop-filter:blur(20px); border-top:1px solid var(--border); display:flex; padding:8px 16px; padding-bottom:calc(8px + env(safe-area-inset-bottom)); z-index:100; }
        .nav-item { flex:1; display:flex; flex-direction:column; align-items:center; gap:4px; padding:8px; background:none; border:none; color:var(--muted); cursor:pointer; transition:color 0.2s; }
        .nav-item.on { color:var(--gold); }
        .nav-icon { font-size:20px; }
        .nav-lbl { font-size:10px; font-weight:500; }
        
        .toast { position:fixed; bottom:80px; left:50%; transform:translateX(-50%) translateY(100px); background:var(--bg2); border:1px solid var(--border); padding:12px 20px; border-radius:12px; font-size:13px; font-weight:500; opacity:0; transition:all 0.4s; z-index:1000; }
        .toast.show { opacity:1; transform:translateX(-50%) translateY(0); }
        .toast.ok { border-color:var(--green); color:var(--green); }
        .toast.err { border-color:var(--red); color:var(--red); }
        
        .empty { text-align:center; padding:40px 20px; }
        .empty-icon { font-size:48px; margin-bottom:12px; }
        .empty-text { font-size:16px; font-weight:600; margin-bottom:6px; }
        .empty-sub { font-size:13px; color:var(--muted); }
        
        /* Modal */
        .modal-overlay { position:fixed; top:0; left:0; right:0; bottom:0; background:rgba(0,0,0,0.7); z-index:2000; display:none; align-items:center; justify-content:center; padding:20px; }
        .modal-overlay.show { display:flex; }
        .modal { background:var(--bg2); border-radius:20px; padding:24px; width:100%; max-width:360px; border:1px solid var(--border); max-height:80vh; overflow-y:auto; }
        .modal-title { font-size:18px; font-weight:700; margin-bottom:20px; text-align:center; }
        .modal-btns { display:flex; gap:10px; margin-top:20px; }
        .modal-btn { flex:1; padding:12px; border-radius:12px; border:none; font-size:14px; font-weight:600; cursor:pointer; }
        .modal-btn.save { background:var(--green); color:#000; }
        .modal-btn.cancel { background:var(--glass); color:var(--text); border:1px solid var(--border); }
        .modal-btn.delete { background:var(--red); color:#fff; }
        
        /* Icon picker */
        .icon-grid { display:grid; grid-template-columns:repeat(6,1fr); gap:8px; margin-bottom:16px; }
        .icon-opt { width:100%; aspect-ratio:1; border-radius:12px; border:2px solid var(--border); background:var(--glass); font-size:24px; cursor:pointer; display:flex; align-items:center; justify-content:center; }
        .icon-opt.on { border-color:var(--purple); background:var(--purple); }
        .color-grid { display:grid; grid-template-columns:repeat(6,1fr); gap:8px; }
        .color-opt { width:100%; aspect-ratio:1; border-radius:50%; border:3px solid transparent; cursor:pointer; }
        .color-opt.on { border-color:#fff; }
    </style>
</head>
<body>
    <div class="orb orb1"></div>
    <div class="orb orb2"></div>
    
    <div class="app">
        <!-- HOME -->
        <div id="v-home" class="view on">
            <div class="header">
                <span class="page-title">–£—á–∏—Ç—å</span>
            </div>
            <div class="home-counter">–û—Å—Ç–∞–ª–æ—Å—å: <b id="remaining">0</b> —Å–ª–æ–≤</div>
            <div class="mode-switch">
                <button class="mode-btn on" id="mode-learn">üìö –£—á–∏—Ç—å</button>
                <button class="mode-btn" id="mode-repeat">üîÑ –ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ</button>
            </div>
            <div class="card-wrap">
                <div class="card" id="card">
                    <div class="card-face card-front">
                        <div class="card-cat" id="c-cat">‚Äî</div>
                        <div class="card-word" id="c-word">–î–æ–±–∞–≤—å —Å–ª–æ–≤–∞</div>
                        <div class="card-phon" id="c-phon"></div>
                        <div class="tap-hint">üëÜ –ù–∞–∂–º–∏ –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞</div>
                    </div>
                    <div class="card-face card-back">
                        <div class="card-cat">–ü–µ—Ä–µ–≤–æ–¥</div>
                        <div class="card-trans" id="c-trans">‚Äî</div>
                        <div class="card-ex" id="c-ex"></div>
                    </div>
                </div>
            </div>
            <div class="btns">
                <button class="btn btn-no" id="b-no">‚úï</button>
                <button class="btn btn-skip" id="b-skip">‚Ü∑</button>
                <button class="btn btn-yes" id="b-yes">‚úì</button>
            </div>
        </div>
        
        <!-- PROGRESS -->
        <div id="v-progress" class="view">
            <div class="header"><span class="page-title">–ü—Ä–æ–≥—Ä–µ—Å—Å</span></div>
            <div class="streak-card">
                <div class="streak-icon">üî•</div>
                <div class="streak-info"><h3 id="p-streak">0 –¥–Ω–µ–π</h3><p>–°–µ—Ä–∏—è –æ–±—É—á–µ–Ω–∏—è</p></div>
            </div>
            <div class="stats-grid">
                <div class="stat-card"><div class="stat-val" id="p-total">0</div><div class="stat-lbl">–í—Å–µ–≥–æ —Å–ª–æ–≤</div></div>
                <div class="stat-card"><div class="stat-val green" id="p-learned">0</div><div class="stat-lbl">–í—ã—É—á–µ–Ω–æ</div></div>
                <div class="stat-card"><div class="stat-val purple" id="p-today">0</div><div class="stat-lbl">–°–µ–≥–æ–¥–Ω—è</div></div>
            </div>
            <div class="section-title">–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∑–∞ –Ω–µ–¥–µ–ª—é</div>
            <div class="week-chart" id="week-chart"></div>
        </div>
        
        <!-- DECKS -->
        <div id="v-decks" class="view">
            <div class="header"><span class="page-title">–ö–æ–ª–æ–¥—ã</span></div>
            <div id="decks-list"><div class="decks" id="decks"></div></div>
            <div id="deck-detail" style="display:none">
                <div class="detail-head">
                    <button class="back-btn" id="back">‚Üê</button>
                    <span class="detail-title" id="d-title">–ö–æ–ª–æ–¥–∞</span>
                    <div class="detail-actions">
                        <button class="detail-btn edit" id="edit-deck">‚úèÔ∏è</button>
                        <button class="detail-btn delete" id="delete-deck">üóë</button>
                    </div>
                </div>
                <div class="words" id="words"></div>
                <button class="study-btn" id="study">üìñ –£—á–∏—Ç—å —ç—Ç—É –∫–æ–ª–æ–¥—É</button>
            </div>
        </div>
        
        <!-- ADD -->
        <div id="v-add" class="view">
            <div class="header"><span class="page-title">–î–æ–±–∞–≤–∏—Ç—å</span></div>
            <div class="form-group"><label class="form-lbl">–°–ª–æ–≤–æ</label><input class="form-input" id="i-word" placeholder="example"></div>
            <div class="form-group"><label class="form-lbl">–¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è</label><input class="form-input" id="i-phon" placeholder="/…™…°Ààz√¶mp…ôl/"></div>
            <div class="form-group"><label class="form-lbl">–ü–µ—Ä–µ–≤–æ–¥</label><input class="form-input" id="i-trans" placeholder="–ø—Ä–∏–º–µ—Ä"></div>
            <div class="form-group"><label class="form-lbl">–ü—Ä–∏–º–µ—Ä</label><input class="form-input" id="i-ex" placeholder="This is an example."></div>
            <div class="form-group">
                <label class="form-lbl">–ö–æ–ª–æ–¥–∞</label>
                <select class="form-input" id="i-deck"></select>
            </div>
            <button class="submit-btn" id="add-btn">–î–æ–±–∞–≤–∏—Ç—å</button>
        </div>
        
        <!-- SETTINGS -->
        <div id="v-settings" class="view">
            <div class="header"><span class="page-title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span></div>
            <div class="section">
                <div class="section-head">–û–±—É—á–µ–Ω–∏–µ</div>
                <div class="row"><span>–ö–∞—Ä—Ç–æ—á–µ–∫ –≤ –¥–µ–Ω—å</span><div class="cnt-sel"><button class="cnt-btn" data-n="10">10</button><button class="cnt-btn on" data-n="20">20</button><button class="cnt-btn" data-n="30">30</button></div></div>
                <div class="row"><span>–¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è</span><div class="toggle on" id="t-phon"></div></div>
                <div class="row"><span>–ü—Ä–∏–º–µ—Ä—ã</span><div class="toggle on" id="t-ex"></div></div>
            </div>
            <div class="section">
                <div class="section-head">–î–∞–Ω–Ω—ã–µ</div>
                <div class="row"><span>–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è</span><button class="cnt-btn" id="sync">‚òÅÔ∏è</button></div>
                <div class="row"><span>–°–±—Ä–æ—Å –ø—Ä–æ–≥—Ä–µ—Å—Å–∞</span><button class="cnt-btn danger" id="reset">üóë</button></div>
            </div>
        </div>
    </div>
    
    <nav class="nav">
        <button class="nav-item on" data-v="home"><span class="nav-icon">üé¥</span><span class="nav-lbl">–£—á–∏—Ç—å</span></button>
        <button class="nav-item" data-v="progress"><span class="nav-icon">üìä</span><span class="nav-lbl">–ü—Ä–æ–≥—Ä–µ—Å—Å</span></button>
        <button class="nav-item" data-v="decks"><span class="nav-icon">üìÇ</span><span class="nav-lbl">–ö–æ–ª–æ–¥—ã</span></button>
        <button class="nav-item" data-v="add"><span class="nav-icon">‚ûï</span><span class="nav-lbl">–î–æ–±–∞–≤–∏—Ç—å</span></button>
        <button class="nav-item" data-v="settings"><span class="nav-icon">‚öôÔ∏è</span><span class="nav-lbl">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span></button>
    </nav>
    
    <div class="toast" id="toast"></div>
    
    <!-- Modal: Edit Word -->
    <div class="modal-overlay" id="edit-modal">
        <div class="modal">
            <div class="modal-title">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–ª–æ–≤–æ</div>
            <div class="form-group"><label class="form-lbl">–°–ª–æ–≤–æ</label><input class="form-input" id="e-word"></div>
            <div class="form-group"><label class="form-lbl">–¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è</label><input class="form-input" id="e-phon"></div>
            <div class="form-group"><label class="form-lbl">–ü–µ—Ä–µ–≤–æ–¥</label><input class="form-input" id="e-trans"></div>
            <div class="form-group"><label class="form-lbl">–ü—Ä–∏–º–µ—Ä</label><input class="form-input" id="e-ex"></div>
            <div class="form-group"><label class="form-lbl">–ö–æ–ª–æ–¥–∞</label><select class="form-input" id="e-deck"></select></div>
            <div class="modal-btns">
                <button class="modal-btn cancel" id="edit-cancel">–û—Ç–º–µ–Ω–∞</button>
                <button class="modal-btn delete" id="edit-delete">üóë</button>
                <button class="modal-btn save" id="edit-save">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>
    
    <!-- Modal: Create/Edit Deck -->
    <div class="modal-overlay" id="deck-modal">
        <div class="modal">
            <div class="modal-title" id="deck-modal-title">–ù–æ–≤–∞—è –∫–æ–ª–æ–¥–∞</div>
            <div class="form-group"><label class="form-lbl">–ù–∞–∑–≤–∞–Ω–∏–µ</label><input class="form-input" id="d-name" placeholder="–ú–æ—è –∫–æ–ª–æ–¥–∞"></div>
            <div class="form-group">
                <label class="form-lbl">–ò–∫–æ–Ω–∫–∞</label>
                <div class="icon-grid" id="icon-grid"></div>
            </div>
            <div class="form-group">
                <label class="form-lbl">–¶–≤–µ—Ç</label>
                <div class="color-grid" id="color-grid"></div>
            </div>
            <div class="modal-btns">
                <button class="modal-btn cancel" id="deck-cancel">–û—Ç–º–µ–Ω–∞</button>
                <button class="modal-btn save" id="deck-save">–°–æ–∑–¥–∞—Ç—å</button>
            </div>
        </div>
    </div>
    
    <script>
    const tg = window.Telegram?.WebApp;
    if(tg){ tg.ready(); tg.expand(); tg.setHeaderColor('#0a0a0f'); tg.setBackgroundColor('#0a0a0f'); }
    const haptic = () => tg?.HapticFeedback?.impactOccurred('light');
    const cloud = tg?.CloudStorage;
    
    // –ò–∫–æ–Ω–∫–∏ –∏ —Ü–≤–µ—Ç–∞ –¥–ª—è –∫–æ–ª–æ–¥
    const ICONS = ['üìó','üìò','üìï','üìô','üìì','üìî','üìö','üìñ','üéØ','üé®','üé≠','üé™','üåü','‚≠ê','üí´','‚ú®','üî•','üíé','üéÅ','üéÄ','üèÜ','ü•á','üéñÔ∏è','üåà','üå∏','üå∫','üçÄ','üåø','üåô','‚òÄÔ∏è'];
    const COLORS = ['#4ade80','#22d3ee','#818cf8','#a78bfa','#f472b6','#fb7185','#f97316','#facc15','#a3e635','#2dd4bf','#60a5fa','#c084fc'];
    
    // –ù–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    const defaultDecks = {
        basic: {name:'–ë–∞–∑–æ–≤—ã–µ', icon:'üìó', color:'#4ade80'},
        intermediate: {name:'–°—Ä–µ–¥–Ω–∏–µ', icon:'üìò', color:'#60a5fa'},
        advanced: {name:'–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ', icon:'üìï', color:'#f472b6'},
        idioms: {name:'–ò–¥–∏–æ–º—ã', icon:'üìô', color:'#f97316'}
    };
    
    const defaultWords = [
        {word:'have', trans:'–∏–º–µ—Ç—å', ex:'I <em>have</em> a car.', deck:'basic', learned:false},
        {word:'want', trans:'—Ö–æ—Ç–µ—Ç—å', ex:'I <em>want</em> coffee.', deck:'basic', learned:false},
        {word:'know', trans:'–∑–Ω–∞—Ç—å', ex:'I <em>know</em> the answer.', deck:'basic', learned:false},
        {word:'do', trans:'–¥–µ–ª–∞—Ç—å', ex:'What do you <em>do</em>?', deck:'basic', learned:false},
        {word:'make', trans:'–¥–µ–ª–∞—Ç—å', ex:'Let\'s <em>make</em> a cake.', deck:'basic', learned:false},
        {word:'take', trans:'–±—Ä–∞—Ç—å', ex:'<em>Take</em> my hand.', deck:'basic', learned:false},
        {word:'can', trans:'–º–æ—á—å', ex:'I <em>can</em> swim.', deck:'basic', learned:false},
        {word:'work', trans:'—Ä–∞–±–æ—Ç–∞—Ç—å', ex:'I <em>work</em> from home.', deck:'basic', learned:false},
        {word:'buy', trans:'–∫—É–ø–∏—Ç—å', ex:'I want to <em>buy</em> a phone.', deck:'basic', learned:false},
        {word:'get', trans:'–ø–æ–ª—É—á–∞—Ç—å', ex:'Did you <em>get</em> my message?', deck:'basic', learned:false},
        {word:'use', trans:'–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å', ex:'Can I <em>use</em> your pen?', deck:'basic', learned:false},
        {word:'go', trans:'–∏–¥—Ç–∏', ex:'Let\'s <em>go</em> home.', deck:'basic', learned:false},
        {word:'come', trans:'–ø—Ä–∏—Ö–æ–¥–∏—Ç—å', ex:'Please <em>come</em> here.', deck:'basic', learned:false},
        {word:'leave', trans:'—É—Ö–æ–¥–∏—Ç—å', ex:'I have to <em>leave</em> now.', deck:'basic', learned:false},
        {word:'stop', trans:'–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è', ex:'<em>Stop</em> the car!', deck:'basic', learned:false},
        {word:'understand', trans:'–ø–æ–Ω–∏–º–∞—Ç—å', ex:'I don\'t <em>understand</em>.', deck:'basic', learned:false},
        {word:'speak', trans:'–≥–æ–≤–æ—Ä–∏—Ç—å', ex:'Do you <em>speak</em> English?', deck:'basic', learned:false},
        {word:'say', trans:'—Å–∫–∞–∑–∞—Ç—å', ex:'What did you <em>say</em>?', deck:'basic', learned:false},
        {word:'ask', trans:'—Å–ø—Ä–∞—à–∏–≤–∞—Ç—å', ex:'Can I <em>ask</em> a question?', deck:'basic', learned:false},
        {word:'eat', trans:'–µ—Å—Ç—å', ex:'Let\'s <em>eat</em> lunch.', deck:'basic', learned:false},
        {word:'drink', trans:'–ø–∏—Ç—å', ex:'I <em>drink</em> tea every day.', deck:'basic', learned:false},
        {word:'see', trans:'–≤–∏–¥–µ—Ç—å', ex:'I can <em>see</em> the mountain.', deck:'basic', learned:false},
        {word:'look', trans:'—Å–º–æ—Ç—Ä–µ—Ç—å', ex:'<em>Look</em> at this!', deck:'basic', learned:false},
        {word:'show', trans:'–ø–æ–∫–∞–∑—ã–≤–∞—Ç—å', ex:'<em>Show</em> me the way.', deck:'basic', learned:false},
        {word:'like', trans:'–Ω—Ä–∞–≤–∏—Ç—å—Å—è', ex:'I <em>like</em> pizza.', deck:'basic', learned:false},
        {word:'remember', trans:'–ø–æ–º–Ω–∏—Ç—å', ex:'I <em>remember</em> you.', deck:'basic', learned:false},
        {word:'forget', trans:'–∑–∞–±—ã–≤–∞—Ç—å', ex:'Don\'t <em>forget</em> your keys.', deck:'basic', learned:false},
        {word:'read', trans:'—á–∏—Ç–∞—Ç—å', ex:'I <em>read</em> books every night.', deck:'basic', learned:false},
        {word:'write', trans:'–ø–∏—Å–∞—Ç—å', ex:'Please <em>write</em> your name.', deck:'basic', learned:false},
        {word:'keep', trans:'—Ö—Ä–∞–Ω–∏—Ç—å', ex:'<em>Keep</em> it safe.', deck:'basic', learned:false},
        {word:'stay', trans:'–æ—Å—Ç–∞–≤–∞—Ç—å—Å—è', ex:'<em>Stay</em> here with me.', deck:'basic', learned:false},
        {word:'who', trans:'–∫—Ç–æ', ex:'<em>Who</em> is that?', deck:'basic', learned:false},
        {word:'what', trans:'—á—Ç–æ', ex:'<em>What</em> is your name?', deck:'basic', learned:false},
        {word:'where', trans:'–≥–¥–µ', ex:'<em>Where</em> do you live?', deck:'basic', learned:false},
        {word:'when', trans:'–∫–æ–≥–¥–∞', ex:'<em>When</em> is your birthday?', deck:'basic', learned:false},
        {word:'which', trans:'–∫–æ—Ç–æ—Ä—ã–π', ex:'<em>Which</em> one do you want?', deck:'basic', learned:false},
        {word:'whose', trans:'—á–µ–π', ex:'<em>Whose</em> bag is this?', deck:'basic', learned:false},
        {word:'why', trans:'–ø–æ—á–µ–º—É', ex:'<em>Why</em> are you late?', deck:'basic', learned:false},
        {word:'how', trans:'–∫–∞–∫', ex:'<em>How</em> are you?', deck:'basic', learned:false},
        {word:'only', trans:'—Ç–æ–ª—å–∫–æ', ex:'I have <em>only</em> one.', deck:'basic', learned:false},
        {word:'later', trans:'–ø–æ–∑–∂–µ', ex:'See you <em>later</em>.', deck:'basic', learned:false},
        {word:'before', trans:'–¥–æ, –ø–µ—Ä–µ–¥', ex:'Think <em>before</em> you speak.', deck:'basic', learned:false},
        {word:'after', trans:'–ø–æ—Å–ª–µ', ex:'Let\'s meet <em>after</em> work.', deck:'basic', learned:false},
        {word:'today', trans:'—Å–µ–≥–æ–¥–Ω—è', ex:'I\'m busy <em>today</em>.', deck:'basic', learned:false},
        {word:'tomorrow', trans:'–∑–∞–≤—Ç—Ä–∞', ex:'See you <em>tomorrow</em>.', deck:'basic', learned:false},
        {word:'yesterday', trans:'–≤—á–µ—Ä–∞', ex:'I saw him <em>yesterday</em>.', deck:'basic', learned:false},
        {word:'together', trans:'–≤–º–µ—Å—Ç–µ', ex:'Let\'s go <em>together</em>.', deck:'basic', learned:false},
        {word:'big', trans:'–±–æ–ª—å—à–æ–π', ex:'It\'s a <em>big</em> house.', deck:'basic', learned:false},
        {word:'small', trans:'–º–∞–ª–µ–Ω—å–∫–∏–π', ex:'This is too <em>small</em>.', deck:'basic', learned:false},
        {word:'open', trans:'–æ—Ç–∫—Ä—ã—Ç—ã–π', ex:'The door is <em>open</em>.', deck:'basic', learned:false},
        {word:'closed', trans:'–∑–∞–∫—Ä—ã—Ç—ã–π', ex:'The shop is <em>closed</em>.', deck:'basic', learned:false},
        {word:'far', trans:'–¥–∞–ª–µ–∫–æ', ex:'It\'s too <em>far</em> to walk.', deck:'basic', learned:false},
        {word:'near', trans:'–±–ª–∏–∑–∫–æ', ex:'The station is <em>near</em>.', deck:'basic', learned:false},
        {word:'first', trans:'–ø–µ—Ä–≤—ã–π', ex:'This is my <em>first</em> time.', deck:'basic', learned:false},
        {word:'last', trans:'–ø–æ—Å–ª–µ–¥–Ω–∏–π', ex:'It\'s the <em>last</em> chance.', deck:'basic', learned:false},
        {word:'next', trans:'—Å–ª–µ–¥—É—é—â–∏–π', ex:'See you <em>next</em> week.', deck:'basic', learned:false},
        {word:'what time', trans:'–≤–æ —Å–∫–æ–ª—å–∫–æ', ex:'<em>What time</em> is it?', deck:'intermediate', learned:false},
        {word:'how long', trans:'–∫–∞–∫ –¥–æ–ª–≥–æ', ex:'<em>How long</em> does it take?', deck:'intermediate', learned:false},
        {word:'for now', trans:'–ø–æ–∫–∞ —á—Ç–æ', ex:'This is enough <em>for now</em>.', deck:'intermediate', learned:false},
        {word:'unfortunately', trans:'–∫ —Å–æ–∂–∞–ª–µ–Ω–∏—é', ex:'<em>Unfortunately</em>, I can\'t come.', deck:'intermediate', learned:false},
        {word:'everything', trans:'–≤—Å—ë', ex:'<em>Everything</em> is fine.', deck:'intermediate', learned:false},
        {word:'nothing', trans:'–Ω–∏—á–µ–≥–æ', ex:'I have <em>nothing</em> to say.', deck:'intermediate', learned:false},
        {word:'the rest', trans:'–æ—Å—Ç–∞–ª—å–Ω–æ–µ', ex:'I\'ll do <em>the rest</em>.', deck:'intermediate', learned:false},
        {word:'separately', trans:'–æ—Ç–¥–µ–ª—å–Ω–æ', ex:'We paid <em>separately</em>.', deck:'intermediate', learned:false},
        {word:'previous', trans:'–ø—Ä–µ–¥—ã–¥—É—â–∏–π', ex:'Check the <em>previous</em> page.', deck:'intermediate', learned:false},
        {word:'drunk', trans:'–ø—å—è–Ω—ã–π', ex:'He was <em>drunk</em> last night.', deck:'intermediate', learned:false},
        {word:'sober', trans:'—Ç—Ä–µ–∑–≤—ã–π', ex:'I\'m completely <em>sober</em>.', deck:'intermediate', learned:false}
    ];
    
    let S = {
        words: [],
        decks: {},
        stats: { streak:0, daily:{} },
        mode: 'learn',
        currentDeck: null
    };
    
    const $=id=>document.getElementById(id);
    let shuffled=[], idx=0, editingWord=null, editingDeck=null, selectedIcon=ICONS[0], selectedColor=COLORS[0];
    
    // Save/Load
    function save(){
        const data = JSON.stringify(S);
        try { localStorage.setItem('wordly2', data); } catch(e){}
        if(cloud) cloud.setItem('wordly2_data', data, ()=>{});
    }
    
    function load(){
        const local = localStorage.getItem('wordly2');
        if(local){
            try { Object.assign(S, JSON.parse(local)); } catch(e){}
        }
        if(!S.words.length){
            S.words = [...defaultWords];
            S.decks = {...defaultDecks};
        }
        if(!Object.keys(S.decks).length) S.decks = {...defaultDecks};
        
        if(cloud){
            cloud.getItem('wordly2_data', (err, val)=>{
                if(!err && val){
                    try { 
                        const d = JSON.parse(val);
                        if(d.words?.length > S.words.length) Object.assign(S, d);
                    } catch(e){}
                }
                update();
            });
        } else {
            update();
        }
    }
    
    // Shuffle
    function shuffle(arr){
        const a=[...arr];
        for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]]; }
        return a;
    }
    function reshuffle(){
        let words = S.currentDeck ? S.words.filter(w=>w.deck===S.currentDeck) : S.words;
        if(S.mode==='learn') words = words.filter(w=>!w.learned);
        shuffled = shuffle(words);
        idx = 0;
    }
    
    // UI
    function update(){
        renderDecks();
        renderDeckSelects();
        showCard();
        updateStats();
    }
    
    function showCard(){
        const words = S.currentDeck ? S.words.filter(w=>w.deck===S.currentDeck) : S.words;
        const active = S.mode==='learn' ? words.filter(w=>!w.learned) : words;
        $('remaining').textContent = active.length;
        
        if(!shuffled.length || idx>=shuffled.length) reshuffle();
        if(!shuffled.length){
            $('c-word').textContent = S.mode==='learn' ? '–í—Å—ë –≤—ã—É—á–µ–Ω–æ! üéâ' : '–ù–µ—Ç —Å–ª–æ–≤';
            $('c-trans').textContent = S.mode==='learn' ? '–ü–µ—Ä–µ–∫–ª—é—á–∏—Å—å –Ω–∞ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ' : '–î–æ–±–∞–≤—å –Ω–æ–≤—ã–µ';
            $('c-phon').textContent=''; $('c-cat').textContent='‚Äî'; $('c-ex').textContent='';
            return;
        }
        const w = shuffled[idx];
        $('c-word').textContent = w.word;
        $('c-phon').textContent = w.phon || '';
        $('c-cat').textContent = S.decks[w.deck]?.name || '‚Äî';
        $('c-trans').textContent = w.trans;
        $('c-ex').innerHTML = w.ex || '';
        $('card').classList.remove('flipped');
    }
    
    function next(){ idx++; if(idx>=shuffled.length) reshuffle(); showCard(); }
    function cur(){ return shuffled[idx]; }
    
    function renderDecks(){
        const c = $('decks');
        c.innerHTML = '';
        Object.entries(S.decks).forEach(([k,d])=>{
            const cnt = S.words.filter(w=>w.deck===k).length;
            const el = document.createElement('div');
            el.className = 'deck';
            el.style.borderColor = d.color || '#7c6aef';
            el.innerHTML = `<div class="deck-icon">${d.icon||'üìö'}</div><div class="deck-name">${d.name}</div><div class="deck-cnt">${cnt} —Å–ª–æ–≤</div>`;
            el.onclick = () => openDeck(k);
            c.appendChild(el);
        });
        // Add button
        const add = document.createElement('div');
        add.className = 'deck deck-add';
        add.innerHTML = '<div class="deck-icon">‚ûï</div><div class="deck-name">–°–æ–∑–¥–∞—Ç—å</div>';
        add.onclick = () => openDeckModal();
        c.appendChild(add);
    }
    
    function renderDeckSelects(){
        const opts = Object.entries(S.decks).map(([k,d])=>`<option value="${k}">${d.icon} ${d.name}</option>`).join('');
        $('i-deck').innerHTML = opts;
        $('e-deck').innerHTML = opts;
    }
    
    function openDeck(k){
        haptic(); S.currentDeck = k;
        $('decks-list').style.display = 'none';
        $('deck-detail').style.display = 'block';
        $('d-title').textContent = S.decks[k]?.name || k;
        
        const c = $('words'); c.innerHTML = '';
        const words = S.words.filter(w=>w.deck===k);
        if(!words.length){
            c.innerHTML = '<div class="empty"><div class="empty-icon">üì≠</div><div class="empty-text">–ü—É—Å—Ç–æ</div></div>';
            return;
        }
        words.forEach(w=>{
            const el = document.createElement('div');
            el.className = 'word-item';
            el.innerHTML = `<div><div class="word-w">${w.word}</div><div class="word-t">${w.trans}</div></div><div class="word-status ${w.learned?'learned':''}"></div>`;
            el.onclick = () => openEditWord(w);
            c.appendChild(el);
        });
    }
    
    function closeDeck(){
        haptic();
        $('decks-list').style.display = 'block';
        $('deck-detail').style.display = 'none';
        S.currentDeck = null;
    }
    
    // Word modal
    function openEditWord(w){
        haptic(); editingWord = w;
        $('e-word').value = w.word||'';
        $('e-phon').value = w.phon||'';
        $('e-trans').value = w.trans||'';
        $('e-ex').value = w.ex||'';
        $('e-deck').value = w.deck||'basic';
        $('edit-modal').classList.add('show');
    }
    
    // Deck modal
    function openDeckModal(key=null){
        haptic(); editingDeck = key;
        $('deck-modal-title').textContent = key ? '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–ª–æ–¥—É' : '–ù–æ–≤–∞—è –∫–æ–ª–æ–¥–∞';
        $('deck-save').textContent = key ? '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å' : '–°–æ–∑–¥–∞—Ç—å';
        
        if(key && S.decks[key]){
            $('d-name').value = S.decks[key].name;
            selectedIcon = S.decks[key].icon || ICONS[0];
            selectedColor = S.decks[key].color || COLORS[0];
        } else {
            $('d-name').value = '';
            selectedIcon = ICONS[0];
            selectedColor = COLORS[0];
        }
        renderIconGrid();
        renderColorGrid();
        $('deck-modal').classList.add('show');
    }
    
    function renderIconGrid(){
        $('icon-grid').innerHTML = ICONS.map(i=>`<button class="icon-opt ${i===selectedIcon?'on':''}" data-i="${i}">${i}</button>`).join('');
        $('icon-grid').querySelectorAll('.icon-opt').forEach(b=>b.onclick=()=>{
            selectedIcon = b.dataset.i;
            renderIconGrid();
        });
    }
    
    function renderColorGrid(){
        $('color-grid').innerHTML = COLORS.map(c=>`<button class="color-opt ${c===selectedColor?'on':''}" data-c="${c}" style="background:${c}"></button>`).join('');
        $('color-grid').querySelectorAll('.color-opt').forEach(b=>b.onclick=()=>{
            selectedColor = b.dataset.c;
            renderColorGrid();
        });
    }
    
    function updateStats(){
        const today = new Date().toISOString().split('T')[0];
        $('p-total').textContent = S.words.length;
        $('p-learned').textContent = S.words.filter(w=>w.learned).length;
        $('p-today').textContent = S.stats.daily?.[today] || 0;
        $('p-streak').textContent = (S.stats.streak||0) + ' –¥–Ω–µ–π';
        
        // Week chart
        const chart = $('week-chart'); chart.innerHTML = '';
        const days = ['–ü–Ω','–í—Ç','–°—Ä','–ß—Ç','–ü—Ç','–°–±','–í—Å'];
        for(let i=6;i>=0;i--){
            const d = new Date(); d.setDate(d.getDate()-i);
            const key = d.toISOString().split('T')[0];
            const val = S.stats.daily?.[key] || 0;
            const h = Math.min(val*10, 60);
            chart.innerHTML += `<div class="week-bar"><div class="week-bar-fill" style="height:${h}px"></div><span>${days[d.getDay()||7-1]}</span></div>`;
        }
    }
    
    function recordProgress(){
        const today = new Date().toISOString().split('T')[0];
        if(!S.stats.daily) S.stats.daily = {};
        S.stats.daily[today] = (S.stats.daily[today]||0) + 1;
        save();
    }
    
    // Events
    $('card').onclick = () => { haptic(); $('card').classList.toggle('flipped'); };
    $('b-yes').onclick = () => { haptic(); const w=cur(); if(w){ w.learned=true; recordProgress(); } next(); };
    $('b-no').onclick = () => { haptic(); const w=cur(); if(w) w.learned=false; next(); };
    $('b-skip').onclick = () => { haptic(); next(); };
    
    $('mode-learn').onclick = () => { haptic(); S.mode='learn'; $('mode-learn').classList.add('on'); $('mode-repeat').classList.remove('on'); reshuffle(); showCard(); };
    $('mode-repeat').onclick = () => { haptic(); S.mode='repeat'; $('mode-repeat').classList.add('on'); $('mode-learn').classList.remove('on'); reshuffle(); showCard(); };
    
    $('back').onclick = closeDeck;
    $('study').onclick = () => { haptic(); document.querySelector('[data-v="home"]').click(); reshuffle(); showCard(); };
    $('edit-deck').onclick = () => openDeckModal(S.currentDeck);
    $('delete-deck').onclick = () => {
        if(!S.currentDeck) return;
        if(confirm('–£–¥–∞–ª–∏—Ç—å –∫–æ–ª–æ–¥—É –∏ –≤—Å–µ —Å–ª–æ–≤–∞ –≤ –Ω–µ–π?')){
            S.words = S.words.filter(w=>w.deck!==S.currentDeck);
            delete S.decks[S.currentDeck];
            save(); closeDeck(); update();
            toast('–ö–æ–ª–æ–¥–∞ —É–¥–∞–ª–µ–Ω–∞','ok');
        }
    };
    
    // Add word
    $('add-btn').onclick = () => {
        const word = $('i-word').value.trim();
        const trans = $('i-trans').value.trim();
        if(!word||!trans){ toast('–ó–∞–ø–æ–ª–Ω–∏ —Å–ª–æ–≤–æ –∏ –ø–µ—Ä–µ–≤–æ–¥','err'); return; }
        S.words.push({ word, trans, phon:$('i-phon').value.trim(), ex:$('i-ex').value.trim(), deck:$('i-deck').value, learned:false });
        save(); reshuffle(); update();
        $('i-word').value=''; $('i-phon').value=''; $('i-trans').value=''; $('i-ex').value='';
        toast('–î–æ–±–∞–≤–ª–µ–Ω–æ','ok');
    };
    
    // Edit word modal
    $('edit-cancel').onclick = () => $('edit-modal').classList.remove('show');
    $('edit-save').onclick = () => {
        if(!editingWord) return;
        editingWord.word = $('e-word').value.trim();
        editingWord.phon = $('e-phon').value.trim();
        editingWord.trans = $('e-trans').value.trim();
        editingWord.ex = $('e-ex').value.trim();
        editingWord.deck = $('e-deck').value;
        save(); $('edit-modal').classList.remove('show');
        if(S.currentDeck) openDeck(S.currentDeck);
        toast('–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ','ok');
    };
    $('edit-delete').onclick = () => {
        if(!editingWord) return;
        if(confirm('–£–¥–∞–ª–∏—Ç—å —Å–ª–æ–≤–æ?')){
            S.words = S.words.filter(w=>w!==editingWord);
            save(); $('edit-modal').classList.remove('show');
            reshuffle(); update();
            if(S.currentDeck) openDeck(S.currentDeck);
            toast('–£–¥–∞–ª–µ–Ω–æ','ok');
        }
    };
    $('edit-modal').onclick = e => { if(e.target.id==='edit-modal') $('edit-modal').classList.remove('show'); };
    
    // Deck modal
    $('deck-cancel').onclick = () => $('deck-modal').classList.remove('show');
    $('deck-save').onclick = () => {
        const name = $('d-name').value.trim();
        if(!name){ toast('–í–≤–µ–¥–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ','err'); return; }
        
        if(editingDeck){
            S.decks[editingDeck].name = name;
            S.decks[editingDeck].icon = selectedIcon;
            S.decks[editingDeck].color = selectedColor;
        } else {
            const key = 'deck_' + Date.now();
            S.decks[key] = { name, icon:selectedIcon, color:selectedColor };
        }
        save(); $('deck-modal').classList.remove('show');
        update();
        toast(editingDeck ? '–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ' : '–ö–æ–ª–æ–¥–∞ —Å–æ–∑–¥–∞–Ω–∞','ok');
    };
    $('deck-modal').onclick = e => { if(e.target.id==='deck-modal') $('deck-modal').classList.remove('show'); };
    
    // Nav
    document.querySelectorAll('.nav-item').forEach(b=>b.onclick=()=>{
        haptic();
        document.querySelectorAll('.nav-item').forEach(x=>x.classList.remove('on'));
        b.classList.add('on');
        document.querySelectorAll('.view').forEach(v=>v.classList.remove('on'));
        $(('v-'+b.dataset.v)).classList.add('on');
        if(b.dataset.v==='decks') closeDeck();
    });
    
    // Settings
    document.querySelectorAll('.toggle').forEach(t=>t.onclick=()=>{ haptic(); t.classList.toggle('on'); });
    document.querySelectorAll('.cnt-btn[data-n]').forEach(b=>b.onclick=()=>{ haptic(); document.querySelectorAll('.cnt-btn[data-n]').forEach(x=>x.classList.remove('on')); b.classList.add('on'); });
    
    $('sync').onclick = () => {
        haptic();
        if(cloud){
            const data = JSON.stringify(S);
            cloud.setItem('wordly2_data', data, (err)=>{
                toast(err ? '–û—à–∏–±–∫–∞' : '–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ ‚òÅÔ∏è', err ? 'err' : 'ok');
            });
        } else {
            toast('–û—Ç–∫—Ä–æ–π—Ç–µ –≤ Telegram','err');
        }
    };
    
    $('reset').onclick = () => {
        if(confirm('–°–±—Ä–æ—Å–∏—Ç—å –≤–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å—Å?')){
            S.words.forEach(w=>w.learned=false);
            S.stats = { streak:0, daily:{} };
            save(); update();
            toast('–ü—Ä–æ–≥—Ä–µ—Å—Å —Å–±—Ä–æ—à–µ–Ω','ok');
        }
    };
    
    function toast(m,t='ok'){ const el=$('toast'); el.textContent=m; el.className=`toast ${t} show`; setTimeout(()=>el.classList.remove('show'),2500); }
    
    load();
    </script>
</body>
</html>
